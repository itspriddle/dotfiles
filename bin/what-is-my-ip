#!/usr/bin/env bash
# Usage: what-is-my-ip
#
# NAME
#   what-is-my-ip -- Get your public IP address from CloudFlare DNS
#
# OPTIONS
#   -h, --help
#     Print this help message and exit.
#
# SEE ALSO
#   dig(1)

if [ "${1:-}" = "-h" ] || [ "${1:-}" = "--help" ]; then
  sed -ne '/^#/!q;s/^#$/# /;/^# /s/^# //p' < "$0" |
    awk -v f="${1//-/}" 'f == "h" && $1 == "Usage:" { print; exit }; f != "h"'
  exit 1
elif [ "$#" -gt 0 ]; then
  echo "Error: Invalid arguments"
  exec "$0" -h
fi

dig @1.1.1.1 ch txt whoami.cloudflare +short | tr -d '"'
