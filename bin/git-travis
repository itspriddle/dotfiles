#!/bin/sh

#/ Usage: git travis
#/
#/ Open a browser on travis-ci.org/GITHUB_NAME/REPO_NAME

usage() {
    grep '^#/' <"$0" | cut -c4-
    exit 0
}

die() {
  echo $1
  exit 1
}

if [[ $# -gt 0 ]]; then
  usage
fi

REMOTE_NAME=$(git remote 2> /dev/null)
REMOTE_URL=$(git config remote.$REMOTE_NAME.url 2> /dev/null)

if [[ $REMOTE_URL != *github.com* ]]; then
  die "Not a github URL"
fi

if [[ $REMOTE_URL == git@github.com* ]]; then
  TRAVIS=$(echo $REMOTE_URL | sed -e 's#git@github.com:#http://travis-ci.org/#')
elif [[ $REMOTE_URL == git://github.com* ]]; then
  TRAVIS=$(echo $REMOTE_URL | sed -e 's#git://github.com#http://travis-ci.org#')
fi

open ${TRAVIS/.git/}
